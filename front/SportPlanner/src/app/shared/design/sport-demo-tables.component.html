<section class="p-6 bg-slate-50 dark:bg-slate-900 rounded-lg">
  <header class="flex items-center justify-between mb-6">
    <div>
      <h2 class="text-2xl font-extrabold text-slate-900 dark:text-slate-100">Equipos</h2>
      <p class="text-sm text-slate-500 dark:text-slate-400">Vista de tabla y tarjetas — datos de demostración</p>
    </div>

    <div class="flex items-center gap-3">
      <div class="flex items-center bg-white/60 dark:bg-slate-800/60 border rounded-full px-3 py-1 shadow-sm">
        <input
          class="bg-transparent outline-none text-sm text-slate-700 dark:text-slate-200 placeholder:text-slate-400"
          placeholder="Buscar por nombre o ciudad..."
          [value]="search()"
          (input)="search.set($any($event.target).value)"
        />
        <button class="ml-2 text-xs text-slate-500" (click)="search.set('')">Limpiar</button>
      </div>

      <div class="inline-flex rounded-lg bg-white/60 dark:bg-slate-800/60 p-1 shadow-sm">
        <button
          (click)="view.set('table')"
          [class]="view() === 'table' ? 'px-3 py-1 rounded-lg bg-gradient-to-r from-sky-500 to-indigo-600 text-white text-sm font-medium' : 'px-3 py-1 rounded-lg text-sm text-slate-600 dark:text-slate-300'"
        >Tabla</button>
        <button
          (click)="view.set('cards')"
          [class]="view() === 'cards' ? 'px-3 py-1 rounded-lg bg-gradient-to-r from-emerald-500 to-teal-600 text-white text-sm font-medium' : 'px-3 py-1 rounded-lg text-sm text-slate-600 dark:text-slate-300'"
        >Cards</button>
        <button
          (click)="view.set('professional')"
          [class]="view() === 'professional' ? 'px-3 py-1 rounded-lg bg-gradient-to-r from-purple-500 to-pink-600 text-white text-sm font-medium' : 'px-3 py-1 rounded-lg text-sm text-slate-600 dark:text-slate-300'"
        >Professional</button>
      </div>
    </div>
  </header>

  <!-- Professional Table -->
  <div *ngIf="view() === 'professional'">
      <app-professional-table
          [data]="teams()"
          [columns]="professionalColumns"
          [actions]="professionalActions"
          [pagination]="{ pageSize: 10, pageSizeOptions: [5, 10, 25, 50], showTotal: true }"
          (rowClick)="professionalActions[0].onClick($event)">
      </app-professional-table>
  </div>

  <!-- Tabla -->
  <div *ngIf="view() === 'table'" class="overflow-x-auto bg-white/60 dark:bg-slate-800/60 rounded-lg shadow-md p-4">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-3">
        <button (click)="exportCSV()" class="px-3 py-1 rounded-md bg-gradient-to-r from-slate-800 to-slate-900 text-white text-sm dark:from-slate-700 dark:to-black">Export CSV</button>
        <label class="inline-flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300">
          <input type="checkbox" class="rounded" [checked]="compact()" (change)="compact.set($any($event.target).checked)" />
          Compact
        </label>
        <button (click)="showFilters.set(!showFilters())" class="px-2 py-1 rounded-md text-sm bg-white/40 dark:bg-slate-800/40">Filtros</button>
        <div class="text-xs text-slate-500">Resultados: <span class="font-medium">{{ filteredTeams().length }}</span></div>
      </div>
      <div class="text-sm text-slate-500">Orden: <span class="font-medium">{{ sortKey() }} {{ sortDir() === 'asc' ? '↑' : '↓' }}</span></div>
    </div>

    <table class="min-w-full table-auto border-separate" style="border-spacing: 0;">
      <thead class="bg-white/60 dark:bg-slate-800/60 backdrop-blur-sm sticky top-0 z-10">
        <tr class="text-left text-slate-600 dark:text-slate-300 text-sm">
          <th class="px-3 py-3">Equipo</th>
          <th class="px-3 py-3 cursor-pointer" (click)="toggleSort('name')">Ciudad <span class="text-xs">{{ sortKey() === 'name' ? (sortDir() === 'asc' ? '▲' : '▼') : '' }}</span></th>
          <th class="px-3 py-3 cursor-pointer" (click)="toggleSort('members')">Miembros <span class="text-xs">{{ sortKey() === 'members' ? (sortDir() === 'asc' ? '▲' : '▼') : '' }}</span></th>
          <th class="px-3 py-3">Récord</th>
          <th class="px-3 py-3 cursor-pointer" (click)="toggleSort('rating')">Rating <span class="text-xs">{{ sortKey() === 'rating' ? (sortDir() === 'asc' ? '▲' : '▼') : '' }}</span></th>
          <th class="px-3 py-3">Fundado</th>
          <th class="px-3 py-3 sticky right-0 z-20 bg-white/60 dark:bg-slate-800/60">Acciones</th>
        </tr>
      </thead>
      <tbody *ngIf="showFilters()">
        <tr class="bg-white/50 dark:bg-slate-800/50">
          <td class="px-3 py-2">
            <input class="w-full rounded-md border p-1 text-sm" placeholder="Filtrar nombre" [value]="nameFilter()" (input)="nameFilter.set($any($event.target).value)" />
          </td>
          <td class="px-3 py-2">
            <input class="w-full rounded-md border p-1 text-sm" placeholder="Filtrar ciudad" [value]="cityFilter()" (input)="cityFilter.set($any($event.target).value)" />
          </td>
          <td class="px-3 py-2">
            <input class="w-full rounded-md border p-1 text-sm" placeholder="Miembros" [value]="membersFilter()" (input)="membersFilter.set($any($event.target).value)" />
          </td>
          <td class="px-3 py-2"></td>
          <td class="px-3 py-2">
            <input type="number" min="0" max="10" class="w-24 rounded-md border p-1 text-sm" placeholder="Min" [value]="minRating()" (input)="minRating.set($any($event.target).value ? +$any($event.target).value : null)" />
          </td>
          <td class="px-3 py-2"></td>
          <td class="px-3 py-2">
            <button class="px-2 py-1 rounded-md text-xs bg-amber-400" (click)="nameFilter.set(''); cityFilter.set(''); membersFilter.set(''); minRating.set(null)">Limpiar filtros</button>
          </td>
        </tr>
      </tbody>
      <tbody>
        <tr *ngFor="let t of pagedTeams()" [class]="'border-t last:border-b hover:bg-slate-50 dark:hover:bg-slate-900/40 ' + (compact() ? 'text-sm' : 'text-base')">
          <td class="px-3 py-3 flex items-center gap-3">
            <div class="relative">
              <div class="h-10 w-10 flex items-center justify-center rounded-full bg-gradient-to-br from-indigo-500 to-pink-500 text-white font-semibold">{{ t.name.charAt(0) }}</div>
              <div class="absolute -bottom-1 -right-1 w-6 h-6 rounded-full blur-sm" [ngClass]="getStatus(t).color"></div>
            </div>
            <div>
              <div class="font-semibold text-slate-900 dark:text-slate-100">{{ t.name }}</div>
              <div class="text-xs text-slate-500">{{ t.members.slice(0,3).join(', ') }}{{ t.members.length > 3 ? '...' : '' }}</div>
            </div>
            <div class="ml-3">
              <span
                class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"
                [ngClass]="[getStatus(t).text, 'bg-gradient-to-r', getStatus(t).color + '/40']"
              >{{ getStatus(t).label }}</span>
            </div>
          </td>
          <td class="px-3 py-3 text-sm text-slate-700 dark:text-slate-200">{{ t.city }}</td>
          <td class="px-3 py-3 text-sm text-slate-700 dark:text-slate-200">{{ t.members.length }}</td>
          <td class="px-3 py-3 text-sm text-slate-700 dark:text-slate-200">{{ t.wins }} - {{ t.losses }}</td>
          <td class="px-3 py-3">
            <div class="flex items-center gap-3">
              <div class="text-sm font-medium text-slate-900 dark:text-slate-100">{{ t.rating.toFixed(1) }}</div>
              <div class="w-36 h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden">
                <div class="h-2 bg-emerald-400" [style.width.%]="getRatingPercent(t)"></div>
              </div>
            </div>
          </td>
          <td class="px-3 py-3 text-sm text-slate-600 dark:text-slate-300">{{ formatDate(t.founded) }}</td>
          <td class="px-3 py-3">
            <div class="relative">
              <div class="inline-flex gap-2 sticky right-0 z-20 bg-white/60 dark:bg-slate-800/60 p-1 rounded-md backdrop-blur-sm border-l border-slate-200 dark:border-slate-700">
                <button class="px-3 py-1 rounded-md text-xs bg-sky-500 text-white">Ver</button>
                <button class="px-3 py-1 rounded-md text-xs bg-amber-400 text-white">Editar</button>
                <button class="px-3 py-1 rounded-md text-xs bg-slate-200">Más</button>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="flex items-center justify-between mt-3">
      <div class="flex items-center gap-3">
        <label class="text-sm">Mostrar</label>
        <select class="rounded-md p-1" [value]="pageSize()" (change)="setPageSize($any($event.target).value)">
          <option [value]="10">10</option>
          <option [value]="30">30</option>
          <option [value]="0">Todo</option>
        </select>
      </div>

      <div class="flex items-center gap-2">
        <button class="px-2 py-1 rounded-md" (click)="goFirst()"><<</button>
        <button class="px-2 py-1 rounded-md" (click)="goPrev()"><</button>
        <div class="flex items-center gap-1">
          <ng-container *ngFor="let p of pages()">
            <button *ngIf="p >= 0" class="px-2 py-1 rounded-md" [class]="p === pageIndex() ? 'bg-slate-800 text-white' : ''" (click)="goToPage(p)">{{ p + 1 }}</button>
            <span *ngIf="p === -1" class="px-2">…</span>
          </ng-container>
        </div>
        <div class="text-sm">/ {{ totalPages() }}</div>
        <button class="px-2 py-1 rounded-md" (click)="goNext()">></button>
        <button class="px-2 py-1 rounded-md" (click)="goLast()">>></button>
      </div>
    </div>
  </div>

  <!-- Cards -->
  <div *ngIf="view() === 'cards'" class="mt-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let t of filteredTeams()" class="bg-gradient-to-br from-white to-slate-50 dark:from-slate-800 dark:to-slate-900 rounded-xl p-5 shadow-lg hover:scale-105 transform transition">
        <div class="flex items-start justify-between">
          <div class="flex items-center gap-4">
            <div class="h-12 w-12 rounded-full bg-gradient-to-br from-indigo-500 to-rose-500 text-white flex items-center justify-center font-bold text-lg">{{ t.name.charAt(0) }}</div>
            <div>
              <div class="text-lg font-semibold text-slate-900 dark:text-slate-100">{{ t.name }}</div>
              <div class="text-xs text-slate-500 dark:text-slate-400">{{ t.city }} · Fundado {{ t.founded | slice:0:4 }}</div>
            </div>
          </div>
          <div class="text-right">
            <div class="text-sm font-bold text-slate-900 dark:text-slate-100">{{ t.rating.toFixed(1) }}</div>
            <div class="text-xs text-slate-500">{{ t.wins }}W · {{ t.losses }}L</div>
          </div>
        </div>

        <div class="mt-4 flex items-center justify-between">
          <div class="text-sm text-slate-700 dark:text-slate-300">Miembros: <span class="font-medium">{{ t.members.length }}</span></div>
          <div class="inline-flex gap-2">
            <button class="px-3 py-1 rounded-md bg-indigo-600 text-white text-xs">Detalle</button>
            <button class="px-3 py-1 rounded-md bg-slate-200 text-xs">Mensaje</button>
          </div>
        </div>

        <div class="mt-4 text-xs text-slate-500">Jugadores: {{ t.members.join(', ') }}</div>
      </div>
    </div>
  </div>
</section>

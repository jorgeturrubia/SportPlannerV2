<div class="w-full">
  <!-- Header -->
  @if (title() || subtitle()) {
    <div class="mb-6">
      @if (title()) {
        <h2 class="text-2xl font-semibold text-gray-900 dark:text-gray-100">{{ title() }}</h2>
      }
      @if (subtitle()) {
        <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">{{ subtitle() }}</p>
      }
    </div>
  }

  <!-- Search Bar -->
  @if (config().searchable) {
    <div class="mb-4">
      <div class="relative">
        <input
          type="text"
          (input)="onSearch($event)"
          placeholder="Search..."
          class="w-full px-4 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </div>
    </div>
  }

  <!-- Table Container -->
  <div class="overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700 shadow-lg">
    <div class="overflow-x-auto">
      <table class="w-full table-auto divide-y divide-gray-200 dark:divide-gray-700">
        <!-- Table Header -->
        <thead class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 sticky top-0 z-10">
          <tr>
            @for (column of config().columns; track column.key) {
              <th
                [class]="column.width || ''"
                [ngClass]="{
                  'sticky right-0 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 shadow-[-4px_0_8px_rgba(0,0,0,0.1)] dark:shadow-[-4px_0_8px_rgba(0,0,0,0.3)]': column.sticky,
                  'text-left': column.align === 'left' || !column.align,
                  'text-center': column.align === 'center',
                  'text-right': column.align === 'right'
                }"
                class="px-6 py-3 text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider">
                {{ column.label }}
              </th>
            }
          </tr>
        </thead>

        <!-- Table Body -->
        <tbody class="bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700">
          @for (item of paginatedData(); track item) {
            <tr
              (click)="onRowClick(item)"
              class="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-150 cursor-pointer">
              @for (column of config().columns; track column.key) {
                <td
                  [ngClass]="{
                    'sticky right-0 bg-white dark:bg-gray-900 shadow-[-4px_0_8px_rgba(0,0,0,0.1)] dark:shadow-[-4px_0_8px_rgba(0,0,0,0.3)]': column.sticky,
                    'text-left': column.align === 'left' || !column.align,
                    'text-center': column.align === 'center',
                    'text-right': column.align === 'right',
                    'whitespace-nowrap': column.type !== 'text'
                  }"
                  class="px-6 py-4 text-sm">

                  <!-- Badge Type -->
                  @if (column.type === 'badge') {
                    <span
                      [ngClass]="getBadgeClasses(getCellValue(item, column), column)"
                      class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide">
                      {{ getCellValue(item, column) }}
                    </span>
                  }

                  <!-- Number Type -->
                  @else if (column.type === 'number') {
                    <span class="text-gray-900 dark:text-gray-100">{{ getCellValue(item, column) }}</span>
                  }

                  <!-- Date Type -->
                  @else if (column.type === 'date') {
                    <span class="text-gray-900 dark:text-gray-100">{{ getCellValue(item, column) }}</span>
                  }

                  <!-- Custom Render -->
                  @else if (column.type === 'custom' && column.customRender) {
                    <span [innerHTML]="column.customRender(getCellValue(item, column), item)"></span>
                  }

                  <!-- Default Text -->
                  @else {
                    <span class="text-gray-900 dark:text-gray-100">{{ getCellValue(item, column) }}</span>
                  }
                </td>
              }
            </tr>
          }

          <!-- Empty State -->
          @if (paginatedData().length === 0) {
            <tr>
              <td [attr.colspan]="config().columns.length" class="px-6 py-12 text-center">
                <div class="flex flex-col items-center justify-center text-gray-500 dark:text-gray-400">
                  <svg class="w-12 h-12 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                  </svg>
                  <p class="text-lg font-medium">No data available</p>
                  <p class="text-sm">Try adjusting your search or filters</p>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  <!-- Pagination -->
  <div class="mt-4 flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md">
    <div class="flex items-center gap-2">
      <label class="text-sm text-gray-700 dark:text-gray-300">Rows per page:</label>
      <select
        (change)="onPageSizeChange($event)"
        [value]="pageSize()"
        class="border border-gray-300 dark:border-gray-600 rounded-md px-2 py-1 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
        @for (size of pageSizeOptions(); track size) {
          <option [value]="size">{{ size }}</option>
        }
      </select>
    </div>

    <div class="flex items-center gap-2">
      <span class="text-sm text-gray-700 dark:text-gray-300">
        Page {{ pageIndex() + 1 }} of {{ totalPages() }} ({{ totalItems() }} total)
      </span>

      <div class="flex gap-1">
        <button
          (click)="onPageChange(pageIndex() - 1)"
          [disabled]="pageIndex() === 0"
          class="px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150">
          Prev
        </button>
        <button
          (click)="onPageChange(pageIndex() + 1)"
          [disabled]="pageIndex() === totalPages() - 1"
          class="px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150">
          Next
        </button>
      </div>
    </div>
  </div>
</div>
